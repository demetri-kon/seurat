---
title: "Integration with supervised anchor filtering"
output: github_document
---

```{r setup, include=FALSE}library(Seurat)
library(Seurat)
options(Seurat.object.assay.version = "v5")
library(SeuratData)
library(patchwork)
```

```{r}
InstallData('ifnb')
ifnb <- LoadData('ifnb')
```
```{r}
ifnb = UpdateSeuratObject(object = ifnb)
ifnb[["RNA"]] <- as(ifnb[["RNA"]], Class = "Assay5")

ifnb[["RNA"]] <- split(ifnb[["RNA"]], f = ifnb$stim)

ifnb <- NormalizeData(ifnb)
ifnb <- FindVariableFeatures(ifnb, selection.method = "vst", nfeatures = 2000)

ifnb <- ScaleData(ifnb)
ifnb <- RunPCA(ifnb)
```
```{r}
ifnb <- IntegrateLayers(object = ifnb, 
                        method = CCAIntegration,
                        supervised.filter = TRUE,
                        celltype.obj1="seurat_annotations", 
                        celltype.obj2="seurat_annotations")
```
```{r}
saveRDS(ifnb, "/User/path_to_document")
```
